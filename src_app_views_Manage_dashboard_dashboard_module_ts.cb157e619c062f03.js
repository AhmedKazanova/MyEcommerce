"use strict";(self.webpackChunkEcommerce=self.webpackChunkEcommerce||[]).push([["src_app_views_Manage_dashboard_dashboard_module_ts"],{2536:(F,h,l)=>{l.r(h),l.d(h,{DashboardModule:()=>d});var p=l(6895),g=l(9197),A=l(8547),e=l(4650),m=l(5760),f=l(4006);const v=["dateInput"],T=["selectOrders"],D=["inputfrom"],Z=["inputTo"];function C(o,u){if(1&o&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA()()),2&o){const t=u.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.orderDeliveredCount)}}function b(o,u){if(1&o&&(e.TgZ(0,"div",31)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"p",32),e._uU(4),e.qZA()()),2&o){const t=u.$implicit;e.xp6(2),e.Oqu(t.productName),e.xp6(2),e.hij("",t.ratingPercentage," \u0646\u062c\u0648\u0645")}}class c{constructor(u){this._ApiserviceService=u,this.SubscriptionArr=[],this.usersArr=[],this.productRatingArr=[],this.orderArr=[],this.orderSelect=[],this.filterSelect=void 0,this.filterDay=void 0,this.filterFrom=void 0,this.filterTo=void 0}ngOnInit(){this.getproducts(),this.getAllUsersAndOrders()}getproducts(){let u=this._ApiserviceService.get("product").subscribe({next:t=>{(t=t.sort((i,n)=>Number(n.ratingPercentage)-Number(i.ratingPercentage))).length>5&&(t.length=5),this.productRatingArr=t}});this.SubscriptionArr.push(u)}getAllUsersAndOrders(){let u=this._ApiserviceService.get("order").subscribe({next:t=>{this.orderArr=t,this.orderSelect=this.orderArr;let i=this._ApiserviceService.get("mangercontrol/allusers").subscribe({next:n=>{for(let r=0;r<n.length;r++)n[r].orderDeliveredCount=t.filter(s=>s.userId.toLowerCase()==n[r].id.toLowerCase()&&1==s.delivered).length;n=n.sort((r,s)=>Number(s.orderDeliveredCount)-Number(r.orderDeliveredCount)),this.usersArr=n,this.usersArr.length>5&&(this.usersArr.length=5)}});this.SubscriptionArr.push(i)}});this.SubscriptionArr.push(u)}filterBySelect(u){this.filterSelect=Number(u.target.value),this.orderSelect=0==this.filterSelect?this.orderArr:1==this.filterSelect?this.orderArr.filter(t=>!0===t.deliveredProgress&&0==t.delivered&&0==t.orderReturns):2==this.filterSelect?this.orderArr.filter(t=>1==t.delivered):3==this.filterSelect?this.orderArr.filter(t=>1==t.orderReturns&&0==t.delivered):4==this.filterSelect?this.orderArr.filter(t=>0==t.orderSaw):5==this.filterSelect?this.orderArr.filter(t=>!0===t.deliveredProgress&&0==t.delivered&&1==t.orderReturns):6==this.filterSelect?this.orderArr.filter(t=>1==t.clientCancle):7==this.filterSelect?this.orderArr.filter(t=>1==t.adminRefuse):[],this.dateInput.nativeElement.value="",this.inputfrom.nativeElement.value="",this.inputTo.nativeElement.value="",this.filterDay=void 0,this.filterFrom=void 0,this.filterTo=void 0}filterByDay(u){this.filterDay=new Date(u.target.value),this.orderSelect=this.orderArr.filter(t=>`${new Date(t.orderDate).getUTCFullYear()}-${new Date(t.orderDate).getUTCMonth()+1}-${new Date(t.orderDate).getUTCDate()}`==`${this.filterDay.getUTCFullYear()}-${this.filterDay.getUTCMonth()+1}-${this.filterDay.getUTCDate()}`),this.selectOrders.nativeElement.value="",this.inputfrom.nativeElement.value="",this.inputTo.nativeElement.value="",this.filterSelect="",this.filterFrom=void 0,this.filterTo=void 0}period(u,t){if(""!=u&&""!=t){this.filterFrom=new Date(u),this.filterTo=new Date(t);let i=`${this.filterFrom.getUTCFullYear()}-${this.filterFrom.getUTCMonth()+1}-${this.filterFrom.getUTCDate()}`,n=`${this.filterTo.getUTCFullYear()}-${this.filterTo.getUTCMonth()+1}-${this.filterTo.getUTCDate()}`;this.orderSelect=this.orderArr.filter(r=>{var s=new Date(`${new Date(r.orderDate).getUTCFullYear()}-${new Date(r.orderDate).getUTCMonth()+1}-${new Date(r.orderDate).getUTCDate()}`);return s>=new Date(i)&&s<=new Date(n)})}this.filterSelect="",this.selectOrders.nativeElement.value="",this.dateInput.nativeElement.value=""}totalFilterOrder(){return this.orderSelect.reduce((u,t)=>u+this.getItemTotal(t),0)}getItemTotal(u){return u?.totalOrder?u?.totalOrder:0}ngOnDestroy(){for(let u=0;u<this.SubscriptionArr.length;u++)this.SubscriptionArr[u].unsubscribe()}}c.\u0275fac=function(u){return new(u||c)(e.Y36(m.O))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-dashboard"]],viewQuery:function(u,t){if(1&u&&(e.Gf(v,5),e.Gf(T,5),e.Gf(D,5),e.Gf(Z,5)),2&u){let i;e.iGM(i=e.CRH())&&(t.dateInput=i.first),e.iGM(i=e.CRH())&&(t.selectOrders=i.first),e.iGM(i=e.CRH())&&(t.inputfrom=i.first),e.iGM(i=e.CRH())&&(t.inputTo=i.first)}},decls:56,vars:3,consts:[[1,"d-flex","flex-wrap","justify-content-around","align-items-start"],[1,"col-12","col-sm-6","col-md-4","col-lg-3"],[4,"ngFor","ngForOf"],["class","d-flex",4,"ngFor","ngForOf"],[1,"text-center"],[1,"my-3","px-2","text-center","col-12"],["for","filterorder",1,"fs-3","d-block","mb-2"],["name","filterorder","id","filterorder",1,"form-select","fs-3",3,"change"],["selectOrders",""],["value",""],["value","0"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["for","filterdate",1,"fs-3","d-block","mb-2"],["type","date","name","filterdate","id","filterdate",1,"fs-3","form-control",3,"change"],["dateInput",""],[1,"my-3","px-2","text-center","col-12","d-flex","flex-wrap","justify-content-end","align-items-center"],[1,"fs-3","col-12"],[1,"col-6","px-2"],["for","inputfrom",1,"d-block","fs-3"],["id","inputfrom","name","inputfrom","type","date",1,"form-control","fs-3",3,"change"],["inputfrom",""],["for","inputTo",1,"d-block","fs-3"],["id","inputTo","name","inputTo","type","date",1,"form-control","fs-3",3,"change"],["inputTo",""],[1,"fs-3"],[1,"d-flex"],[1,"text-info"]],template:function(u,t){if(1&u){const i=e.EpF();e.TgZ(0,"section",0)(1,"div",1)(2,"p"),e._uU(3,"\u0627\u0639\u0644\u064a 5 \u0639\u0645\u0644\u0627\u0621 \u0627\u0648\u0631\u062f\u0631\u0627\u062a"),e.qZA(),e.YNc(4,C,5,2,"div",2),e.qZA(),e.TgZ(5,"div",1)(6,"p"),e._uU(7,"\u0627\u0639\u0644\u064a 5 \u0645\u0646\u062a\u062c\u0627\u062a \u062a\u0642\u064a\u0645"),e.qZA(),e.YNc(8,b,5,2,"div",3),e.qZA(),e.TgZ(9,"div",1)(10,"p",4),e._uU(11,"\u0627\u062c\u0645\u0627\u0644\u064a \u0627\u0648\u0631\u062f\u0631\u0627\u062a"),e.qZA(),e.TgZ(12,"div",5)(13,"label",6),e._uU(14,"\u0641\u0644\u062a\u0631 \u062d\u0633\u0628 \u0627\u0644\u0627\u0648\u0631\u062f\u0631 "),e.qZA(),e.TgZ(15,"select",7,8),e.NdJ("change",function(r){return t.filterBySelect(r)}),e.TgZ(17,"option",9),e._uU(18,"\u0641\u0644\u062a\u0631"),e.qZA(),e.TgZ(19,"option",10),e._uU(20,"\u0643\u0644 \u0627\u0644\u0627\u0648\u0631\u062f\u0631\u0627\u062a"),e.qZA(),e.TgZ(21,"option",11),e._uU(22,"\u0627\u0644\u0627\u0648\u0631\u062f\u0631\u0627\u062a \u0627\u0644\u0645\u0634\u062d\u0648\u0646\u0629 \u0648\u0644\u0645 \u062a\u0631\u0633\u0644"),e.qZA(),e.TgZ(23,"option",12),e._uU(24,"\u0627\u0644\u0627\u0648\u0631\u062f\u0631\u0627\u062a \u0627\u0644\u0644\u064a \u0648\u0635\u0644\u062a"),e.qZA(),e.TgZ(25,"option",13),e._uU(26,"\u0627\u0644\u0645\u0631\u062a\u062c\u0639"),e.qZA(),e.TgZ(27,"option",14),e._uU(28,"\u0627\u0648\u0631\u062f\u0631\u0627\u062a \u0627\u0644\u062c\u062f\u064a\u062f\u0629 \u0627\u0644\u0644\u064a \u0645\u062a\u0634\u0627\u0641\u062a\u0634"),e.qZA(),e.TgZ(29,"option",15),e._uU(30,"\u0623\u0648\u0631\u062f\u0631\u0627\u062a \u0645\u0634\u062d\u0648\u0646\u0629 \u0648\u0644\u0643\u0646\u0647\u0627 \u0645\u0631\u062a\u062c\u0639"),e.qZA(),e.TgZ(31,"option",16),e._uU(32,"\u0627\u0648\u0631\u062f\u0631\u0627\u062a \u0645\u0644\u063a\u064a\u0629 \u0645\u0646 \u0627\u0644\u0639\u0645\u064a\u0644"),e.qZA(),e.TgZ(33,"option",17),e._uU(34,"\u0627\u0648\u0631\u062f\u0631\u0627\u062a \u0645\u0644\u063a\u064a\u0629 \u0645\u0646 \u0627\u0644\u0627\u062f\u0645\u0646"),e.qZA()()(),e.TgZ(35,"div",5)(36,"label",18),e._uU(37," \u0641\u0644\u062a\u0631 \u062d\u0633\u0628 \u0627\u0644\u064a\u0648\u0645"),e.qZA(),e.TgZ(38,"input",19,20),e.NdJ("change",function(r){return t.filterByDay(r)}),e.qZA()(),e.TgZ(40,"div",21)(41,"p",22),e._uU(42,"\u0641\u0644\u062a\u0631 \u062d\u0633\u0628 \u0627\u0644\u0641\u062a\u0631\u0629"),e.qZA(),e.TgZ(43,"div",23)(44,"label",24),e._uU(45,"\u0645\u0646"),e.qZA(),e.TgZ(46,"input",25,26),e.NdJ("change",function(){e.CHM(i);const r=e.MAs(47),s=e.MAs(52);return e.KtG(t.period(r.value,s.value))}),e.qZA()(),e.TgZ(48,"div",23)(49,"label",27),e._uU(50,"\u0627\u0644\u0649"),e.qZA(),e.TgZ(51,"input",28,29),e.NdJ("change",function(){e.CHM(i);const r=e.MAs(47),s=e.MAs(52);return e.KtG(t.period(r.value,s.value))}),e.qZA()()(),e.TgZ(53,"div")(54,"p",30),e._uU(55),e.qZA()()()()}2&u&&(e.xp6(4),e.Q6J("ngForOf",t.usersArr),e.xp6(4),e.Q6J("ngForOf",t.productRatingArr),e.xp6(47),e.hij(" \u0627\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0627\u0648\u0631\u062f\u0631\u0627\u062a ",t.totalFilterOrder()," "))},dependencies:[p.sg,f.YN,f.Kr],styles:["section[_ngcontent-%COMP%]{background-color:#eee;min-height:100vh}canvas[_ngcontent-%COMP%]{min-height:25rem!important;max-height:25rem!important}p[_ngcontent-%COMP%]{font-size:1.7rem}"]});const _=[{path:"",component:c,title:"Dashboard",resolve:[A.B]}];class a{}a.\u0275fac=function(u){return new(u||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.Bz.forChild(_),g.Bz]});var S=l(4463);class d{}d.\u0275fac=function(u){return new(u||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[p.ez,a,S.aw,f.u5]})}}]);