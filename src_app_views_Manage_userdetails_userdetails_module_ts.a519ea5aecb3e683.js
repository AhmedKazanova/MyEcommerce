"use strict";(self.webpackChunkEcommerce=self.webpackChunkEcommerce||[]).push([["src_app_views_Manage_userdetails_userdetails_module_ts"],{6786:(S,p,n)=>{n.r(p),n.d(p,{UserdetailsModule:()=>d});var c=n(6895),u=n(9197),v=n(515),e=n(4650),g=n(5760);class o{constructor(t,r){this._Router=t,this._ApiserviceService=r}resolve(t,r){const i=t.paramMap.get("id");return i?this._ApiserviceService.getById("mangercontrol",i):v.E}}o.\u0275fac=function(t){return new(t||o)(e.LFG(u.F0),e.LFG(g.O))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"});var h=n(8724),m=n(5079),_=n(2340),f=n(4463);function U(s,t){1&s&&(e.TgZ(0,"span",11),e._uU(1,"DeliveredProgress"),e.qZA())}function A(s,t){1&s&&(e.TgZ(0,"span",12),e._uU(1,"Delivered"),e.qZA())}function Z(s,t){1&s&&(e.TgZ(0,"span",13),e._uU(1,"NoDelivered"),e.qZA())}function b(s,t){1&s&&(e.TgZ(0,"span",14),e._uU(1,"Order Return"),e.qZA())}function C(s,t){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,U,2,0,"span",7),e.YNc(2,A,2,0,"span",8),e.YNc(3,Z,2,0,"span",9),e.YNc(4,b,2,0,"span",10),e.qZA()),2&s){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",1==r.deliveredProgress&&0==r.delivered&&0==r.orderReturns),e.xp6(1),e.Q6J("ngIf",1==r.delivered),e.xp6(1),e.Q6J("ngIf",0==r.delivered&&0==r.orderReturns),e.xp6(1),e.Q6J("ngIf",1==r.orderReturns)}}function T(s,t){1&s&&(e.TgZ(0,"div")(1,"span",15),e._uU(2,"\u062a\u0645 \u0627\u0644\u0627\u0644\u063a\u0627\u0621 \u0645\u0646 \u0627\u0644\u0627\u062f\u0645\u0646"),e.qZA()())}function O(s,t){1&s&&(e.TgZ(0,"div")(1,"span",15),e._uU(2,"\u062a\u0645 \u0627\u0644\u0627\u0644\u063a\u0627\u0621 \u0645\u0646 \u0627\u0644\u0639\u0645\u064a\u0644"),e.qZA()())}const x=function(s){return["/admin/orderdetails/",s]};function I(s,t){if(1&s&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,C,5,4,"div",5),e.YNc(7,T,3,0,"div",5),e.YNc(8,O,3,0,"div",5),e.qZA(),e.TgZ(9,"td")(10,"a",6),e._uU(11,"Show"),e.qZA()()()),2&s){const r=t.$implicit;e.xp6(2),e.Oqu(r.orderID),e.xp6(2),e.Oqu(r.totalOrder),e.xp6(2),e.Q6J("ngIf",0==r.adminRefuse&&0==r.clientCancle),e.xp6(1),e.Q6J("ngIf",1==r.adminRefuse),e.xp6(1),e.Q6J("ngIf",1==r.clientCancle),e.xp6(2),e.Q6J("routerLink",e.VKq(6,x,r.orderID))}}class l{constructor(t,r,i){this._TranslateService=t,this._ApiserviceService=r,this._ActivatedRoute=i,this.SubscriptionArr=[],this.userOrders=[],this.lang=""}ngOnInit(){this.startConnection(),this.userDetails(),this.getAllUserOrders(),this.language(),"Connecting"==this.Hub_Connection?.state?(this.askServerOrderProgress(),this.askServerOrderNotdelivered()):alert("\u0647\u0646\u0627\u0643 \u062e\u0637\u0627 \u0645\u0646 \u0641\u0636\u0644\u0643 \u0627\u0639\u062f \u0627\u0644\u062a\u062d\u062f\u064a\u062b")}language(){this.lang=this._TranslateService.currentLang;let t=this._TranslateService.onLangChange.subscribe({next:r=>{this.lang=r.lang}});this.SubscriptionArr.push(t)}startConnection(){this.Hub_Connection=(new h.s).withUrl(`${_.N.signalrUrl}`,{skipNegotiation:!0,transport:m.n.WebSockets}).build(),this.Hub_Connection.start().then(()=>{}).catch(t=>{console.error("Error Hub Connection",t),alert("Error Hub Start Connection")})}userDetails(){let t=this._ActivatedRoute.data.subscribe({next:r=>{this.userData=r[0],this.userId=r[0].id}});this.SubscriptionArr.push(t)}getAllUserOrders(){this._ApiserviceService.getById("order/userordersforadmin",this.userId).subscribe({next:t=>{this.userOrders=t.reverse()}})}askServerOrderProgress(){this.Hub_Connection?.on("orderProgress",t=>{let r=this.userOrders.find(i=>i.orderID==t.orderID);null!=r&&(r.adminRefuse=t.adminRefuse,r.clientCancle=t.clientCancle,r.delivered=t.delivered,r.deliveredProgress=t.deliveredProgress,r.orderItems=t.orderItems,r.orderReturns=t.orderReturns,r.totalOrder=t.totalOrder)})}askServerOrderNotdelivered(){this.Hub_Connection?.on("orderUpdate",t=>{let r=this.userOrders.find(i=>i.orderID==t.orderID);null!=r&&(r.adminRefuse=t.adminRefuse,r.clientCancle=t.clientCancle,r.delivered=t.delivered,r.deliveredProgress=t.deliveredProgress,r.orderItems=t.orderItems,r.orderReturns=t.orderReturns,r.totalOrder=t.totalOrder)})}trackOrder(t,r){return r?r.orderID:void 0}ngOnDestroy(){for(let t=0;t<this.SubscriptionArr.length;t++)this.SubscriptionArr[t].unsubscribe();this.Hub_Connection?.off(""),"Connecting"==this.Hub_Connection?.state&&this.Hub_Connection?.stop()}}l.\u0275fac=function(t){return new(t||l)(e.Y36(f.sK),e.Y36(g.O),e.Y36(u.gz))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-userdetails"]],decls:24,vars:5,consts:[[1,"fs-2","d-block"],[1,"fs-1","text-center","d-block"],[1,"table-responsive"],[1,"table","table-light","table-hover","table-striped"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"btn","btn-secondary",3,"routerLink"],["class","d-block text-primary",4,"ngIf"],["class","d-block text-success",4,"ngIf"],["class","d-block text-danger",4,"ngIf"],["class","d-block text-warning",4,"ngIf"],[1,"d-block","text-primary"],[1,"d-block","text-success"],[1,"d-block","text-danger"],[1,"d-block","text-warning"],[1,"text-danger"]],template:function(t,r){1&t&&(e.TgZ(0,"section")(1,"span",0),e._uU(2),e.qZA(),e.TgZ(3,"span",0),e._uU(4),e.qZA(),e.TgZ(5,"span",0),e._uU(6),e.qZA(),e.TgZ(7,"div")(8,"span",1),e._uU(9,"User Orders"),e.qZA(),e.TgZ(10,"div",2)(11,"table",3)(12,"thead")(13,"tr")(14,"th"),e._uU(15,"#"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Total Order"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Order State"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Order Details"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,I,12,8,"tr",4),e.qZA()()()()()),2&t&&(e.xp6(2),e.hij("Name : ",null==r.userData?null:r.userData.name,""),e.xp6(2),e.hij("Phone Number: ",null==r.userData?null:r.userData.phoneNumber," "),e.xp6(2),e.hij("Email: ",null==r.userData?null:r.userData.email," "),e.xp6(17),e.Q6J("ngForOf",r.userOrders)("ngForTrackBy",r.trackOrder))},dependencies:[c.sg,c.O5,u.rH]});const D=[{path:"",component:l,title:"User Details",resolve:[o]}];class a{}a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[u.Bz.forChild(D),u.Bz]});class d{}d.\u0275fac=function(t){return new(t||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[c.ez,a,f.aw]})}}]);