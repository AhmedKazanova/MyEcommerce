"use strict";(self.webpackChunkEcommerce=self.webpackChunkEcommerce||[]).push([["src_app_views_user_myorders_myorders_module_ts"],{5942:(H,p,o)=>{o.r(p),o.d(p,{MyordersModule:()=>d});var u=o(6895),l=o(9197),f=o(8724),m=o(5079),h=o(2340),e=o(4650),_=o(4463),b=o(7185),v=o(5760);function C(n,r){1&n&&(e.TgZ(0,"span",27),e._uU(1," \u0627\u0644\u0634\u062d\u0646 : \u062c\u0627\u0631\u064a \u0627\u0644\u0634\u062d\u0646 \u0642\u0631\u064a\u0628\u0627 "),e.qZA())}function Z(n,r){1&n&&(e.TgZ(0,"span",27),e._uU(1," \u0627\u0644\u0634\u062d\u0646 : \u062a\u0645 \u0627\u0644\u0634\u062d\u0646 \u0648\u0627\u0644\u0637\u0644\u0628 \u0641\u064a \u0627\u0644\u0637\u0631\u064a\u0642 "),e.qZA())}function x(n,r){1&n&&(e.TgZ(0,"span",28),e._uU(1," \u062a\u0645 \u0627\u0633\u062a\u0631\u062c\u0627\u0639 \u0627\u0644\u0627\u0648\u0631\u062f\u0631 "),e.qZA())}function y(n,r){1&n&&(e.TgZ(0,"span",18),e._uU(1," \u0627\u0644\u062a\u0648\u0635\u0644 : \u062a\u0645 \u0627\u0644\u062a\u0648\u0635\u064a\u0644"),e.qZA())}function A(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,C,2,0,"span",24),e.YNc(2,Z,2,0,"span",24),e.YNc(3,x,2,0,"span",25),e.YNc(4,y,2,0,"span",26),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0==t.deliveredProgress&&0==t.orderReturns),e.xp6(1),e.Q6J("ngIf",1==t.deliveredProgress&&0==t.delivered&&0==t.orderReturns),e.xp6(1),e.Q6J("ngIf",1==t.orderReturns),e.xp6(1),e.Q6J("ngIf",1==t.delivered&&1==t.deliveredProgress)}}function O(n,r){if(1&n&&(e.ynx(0),e.YNc(1,A,5,4,"div",6),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",0==t.clientCancle)}}function T(n,r){1&n&&(e.TgZ(0,"div")(1,"span",29),e._uU(2,"\u0627\u0648\u0631\u062f\u0631 \u0645\u0644\u063a\u064a "),e.qZA()())}function I(n,r){1&n&&(e.TgZ(0,"div")(1,"span",29),e._uU(2,"\u0627\u0648\u0631\u062f\u0631 \u0645\u0631\u0641\u0648\u0636 "),e.qZA()())}function k(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,g=e.oxw(2);return e.KtG(g.canceOrder(a))}),e._uU(1,"Cancle"),e.qZA()}}function U(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit,g=e.oxw(2);return e.KtG(g.openModel(a))}),e._uU(1,"Delete"),e.qZA()}}const D=function(){return["/user/chat"]},M=function(n){return["/user/myorderdetails",n]};function q(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.qZA(),e.TgZ(12,"td")(13,"span",18),e._uU(14),e.qZA()(),e.TgZ(15,"td"),e.YNc(16,O,2,1,"ng-container",6),e.YNc(17,T,3,0,"div",6),e.YNc(18,I,3,0,"div",6),e.qZA(),e.TgZ(19,"td")(20,"div",19),e.YNc(21,k,2,0,"button",20),e.TgZ(22,"button",21),e._uU(23,"Call"),e.qZA(),e.YNc(24,U,2,0,"button",22),e.TgZ(25,"button",23),e._uU(26,"Show"),e.qZA()()()()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.orderID),e.xp6(2),e.Oqu(e.Dn7(5,13,t.orderDate,"EEEE dd-MM-yyyy hh:mm a","UTC")),e.xp6(3),e.Oqu(t.userAddress),e.xp6(2),e.Oqu(t.orderDetails),e.xp6(2),e.Oqu(t.orderItems.length),e.xp6(3),e.hij("",t.totalOrder," "),e.xp6(2),e.Q6J("ngIf",0==t.adminRefuse),e.xp6(1),e.Q6J("ngIf",1==t.clientCancle),e.xp6(1),e.Q6J("ngIf",1==t.adminRefuse),e.xp6(3),e.Q6J("ngIf",0==t.delivered&&0==t.deliveredProgress&&0==t.clientCancle&&0==t.adminRefuse),e.xp6(1),e.Q6J("routerLink",e.DdM(17,D)),e.xp6(2),e.Q6J("ngIf",1==t.delivered||1==t.clientCancle||1==t.adminRefuse),e.xp6(1),e.Q6J("routerLink",e.VKq(18,M,t.orderID))}}function S(n,r){if(1&n&&(e.ynx(0),e.YNc(1,q,27,20,"tr",17),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.userOrders)("ngForTrackBy",t.trackOrder)}}function N(n,r){1&n&&(e.TgZ(0,"tr")(1,"td",32)(2,"div",33),e._uU(3,"Empty"),e.qZA()()())}class c{constructor(r,t,s,a){this.document=r,this._TranslateService=t,this.toastr=s,this._ApiserviceService=a,this.SubscriptionArr=[],this.lang="",this.userOrders=[],this.userId=""}ngOnInit(){this.language(),this.startConnection(),this.getUserId(),this.getUserOrder(),"Connecting"==this.Hub_Connection?.state?(this.askServerOrderProgress(),this.askServerOrderNotdelivered(),this.askServerOrderUpdate(),this.askServerclientDeleteOrder()):alert("\u0647\u0646\u0627\u0643 \u062e\u0637\u0627 \u0645\u0646 \u0641\u0636\u0644\u0643 \u0627\u0639\u062f \u0627\u0644\u062a\u062d\u062f\u064a\u062b")}language(){this.lang=this._TranslateService.currentLang;let r=this._TranslateService.onLangChange.subscribe({next:t=>{this.lang=t.lang}});this.SubscriptionArr.push(r)}getUserId(){let r=this._ApiserviceService.UserDataFromToken();null!=r&&(this.userId=r.ID)}startConnection(){this.Hub_Connection=(new f.s).withUrl(`${h.N.signalrUrl}`,{skipNegotiation:!0,transport:m.n.WebSockets}).build(),this.Hub_Connection.start().then(()=>{}).catch(r=>{console.error("Error Hub Connection",r),alert("Error Hub Start Connection")})}getUserOrder(){if(null!=this.userId&&null!=this.userId&&""!=this.userId){let r=this._ApiserviceService.getById("order/userordersnotdeletd",this.userId).subscribe({next:t=>{this.userOrders=t.reverse()}});this.SubscriptionArr.push(r)}}canceOrder(r){if("Disconnected"!=this.Hub_Connection?.state){if("Connected"==this.Hub_Connection?.state){if(1==r.deliveredProgress)return void("en"==this.lang?alert("Sorry Order Is Progress"):alert("\u0639\u0641\u0648\u0627 \u0644\u0627 \u064a\u0645\u0643\u0646 \u0627\u0644\u063a\u0627\u0621 \u0627\u0644\u0627\u0648\u0631\u062f\u0631 \u0627\u0644\u0637\u0644\u0628 \u0641\u064a \u0627\u0644\u0637\u0631\u064a\u0642"));r.clientCancle=!0,this.Hub_Connection?.invoke("orderUpdate",r.orderID,r).then(()=>{r.clientCancle=!0,this.toastr.success("en"==this.lang?"Order Cancle":"\u062a\u0645 \u0627\u0644\u063a\u0627\u0621 \u0627\u0644\u0627\u0648\u0631\u062f\u0631")}).catch(t=>console.error(t))}}else alert("\u062a\u0627\u0643\u062f \u0645\u0646 \u0627\u062a\u0635\u0627\u0644\u0643 \u0628\u0627\u0644\u0627\u0646\u062a\u0631\u0646\u062a \u062b\u0645 \u0627\u0639\u062f \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0635\u0641\u062d\u0629")}askServerOrderProgress(){this.Hub_Connection?.on("orderProgress",r=>{let t=this.userOrders.find(s=>s.orderID==r.orderID);null!=t&&(t.adminRefuse=r.adminRefuse,t.clientCancle=r.clientCancle,t.delivered=r.delivered,t.deliveredProgress=r.deliveredProgress,t.orderItems=r.orderItems,t.orderReturns=r.orderReturns,t.totalOrder=r.totalOrder)})}askServerOrderNotdelivered(){this.Hub_Connection?.on("orderUpdate",r=>{let t=this.userOrders.find(s=>s.orderID==r.orderID);null!=t&&(t.adminRefuse=r.adminRefuse,t.clientCancle=r.clientCancle,t.delivered=r.delivered,t.deliveredProgress=r.deliveredProgress,t.orderItems=r.orderItems,t.orderReturns=r.orderReturns,t.totalOrder=r.totalOrder)})}askServerOrderUpdate(){this.Hub_Connection?.on("orderUpdate",r=>{let t=this.userOrders.find(s=>s.orderID===r.orderID);null!=t&&null!=t&&(t.totalOrder=r.totalOrder)})}openModel(r){this.orderDelete=r}clientDeleteOrder(){1==this.orderDelete.clientCancle||1==this.orderDelete.delivered||1==this.orderDelete.adminRefuse?this.orderDelete.orderID>0&&(this.orderDelete.clientDeleted=!0,this.Hub_Connection?.invoke("clientDeleteOrder",this.orderDelete.orderID,this.orderDelete).then(()=>{}).catch(r=>console.error(r))):console.log("No")}askServerclientDeleteOrder(){this.Hub_Connection?.on("clientDeleteOrder",r=>{this.userId==r.userId&&(this.getUserOrder(),this.document.getElementById("closeModel")?.click(),this.toastr.success("en"==this.lang?"Order Deleted Succuss":"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0627\u0648\u0631\u062f\u0631 \u0628\u0646\u062c\u0627\u062d"))})}trackOrder(r,t){return t?t.orderID:void 0}ngOnDestroy(){for(let r=0;r<this.SubscriptionArr.length;r++)this.SubscriptionArr[r].unsubscribe();this.Hub_Connection?.off(""),"Connecting"==this.Hub_Connection?.state&&this.Hub_Connection?.stop(),this.toastr.clear()}}c.\u0275fac=function(r){return new(r||c)(e.Y36(u.K0),e.Y36(_.sK),e.Y36(b._W),e.Y36(v.O))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-myorders"]],decls:43,vars:14,consts:[[1,"py-2","text-center","fs-1"],[1,"table-responsive","mt-4"],[1,"table","table-light","table-striped","table-hover"],[1,"col-1"],[1,"col-3"],[1,"col-2"],[4,"ngIf"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","p-4"],["id","closeModel","type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"text-center","text-danger","fs-4","d-block","py-3"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-block","my-2"],[1,"d-flex","justify-content-end"],["class","btn btn-secondary mx-1 col-4",3,"click",4,"ngIf"],[1,"btn","btn-info","mx-1","text-white","col-4",3,"routerLink"],["class","btn btn-danger mx-1 col-4","data-bs-toggle","modal","data-bs-target","#staticBackdrop",3,"click",4,"ngIf"],[1,"btn","btn-primary","mx-1","col-4",3,"routerLink"],["class","d-block",4,"ngIf"],["class","d-block text-warning",4,"ngIf"],["class","d-block my-2",4,"ngIf"],[1,"d-block"],[1,"d-block","text-warning"],[1,"text-danger"],[1,"btn","btn-secondary","mx-1","col-4",3,"click"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn","btn-danger","mx-1","col-4",3,"click"],["colspan","8"],[1,"alert","alert-danger"]],template:function(r,t){1&r&&(e.TgZ(0,"section")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"table",2)(6,"thead")(7,"tr")(8,"th",3),e._uU(9,"#"),e.qZA(),e.TgZ(10,"th",4),e._uU(11,"Date"),e.qZA(),e.TgZ(12,"th",5),e._uU(13,"Address"),e.qZA(),e.TgZ(14,"th",3),e._uU(15,"Details"),e.qZA(),e.TgZ(16,"th",3),e._uU(17,"CountItem"),e.qZA(),e.TgZ(18,"th",3),e._uU(19,"TotalOrder"),e.qZA(),e.TgZ(20,"th",5),e._uU(21,"State"),e.qZA(),e.TgZ(22,"th",4),e._uU(23,"Option"),e.qZA()()(),e.TgZ(24,"tbody"),e.YNc(25,S,2,2,"ng-container",6),e.YNc(26,N,4,0,"tr",6),e.qZA()()()(),e.TgZ(27,"div",7)(28,"div",8)(29,"div",9)(30,"div",10),e._UZ(31,"button",11),e.qZA(),e.TgZ(32,"div",12)(33,"span",13),e._uU(34),e.ALo(35,"translate"),e.qZA()(),e.TgZ(36,"div",14)(37,"button",15),e.NdJ("click",function(){return t.orderDelete.orderID=0}),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"button",16),e.NdJ("click",function(){return t.clientDeleteOrder()}),e._uU(41),e.ALo(42,"translate"),e.qZA()()()()()),2&r&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"MyOrders")),e.xp6(23),e.Q6J("ngIf",t.userOrders.length>0),e.xp6(1),e.Q6J("ngIf",t.userOrders.length<=0),e.xp6(8),e.Oqu(e.lcZ(35,8,"AreYouSure")),e.xp6(4),e.Oqu(e.lcZ(39,10,"Cancle")),e.xp6(3),e.Oqu(e.lcZ(42,12,"Sure")))},dependencies:[u.sg,u.O5,l.rH,u.uU,_.X$],styles:["section[_ngcontent-%COMP%]{min-height:100vh}td[_ngcontent-%COMP%]{cursor:pointer}button[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{font-size:1.6rem!important;box-shadow:none!important}"]});const J=[{path:"",title:"My Orders",component:c}];class i{}i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.Bz.forChild(J),l.Bz]});class d{}d.\u0275fac=function(r){return new(r||d)},d.\u0275mod=e.oAB({type:d}),d.\u0275inj=e.cJS({imports:[u.ez,i,_.aw]})}}]);